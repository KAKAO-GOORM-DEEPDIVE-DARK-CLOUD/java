# Optional<T>

## 1. 기존 방식의 문제점  
- Java 8 이전에는 메서드가 특정 조건에서 값을 반환할 수 없을 때, **예외를 던지거나 `null`을 반환**하는 방식이 일반적이었다.  
- 그러나 `null`을 반환하면 호출하는 측에서 **별도의 `null` 체크 코드가 필요**하며, 이를 누락하면 `NullPointerException`이 발생할 위험이 있다.  

## 2. `Optional<T>`의 도입  
- Java 8 이후, **`Optional<T>`가 도입**되어 `null`을 직접 반환하는 대신, **값이 있을 수도 없을 수도 있는 경우를 안전하게 표현**할 수 있게 되었다.  
- `Optional<T>`를 반환하면 `null`을 반환하는 방식보다 **명확하고 안전한 코드 작성이 가능**하며, 예외를 던지는 방식보다 **예측 가능하고 사용하기 쉬운 API 설계가 가능**하다.  

---

## 옵셔널 반환을 고려할 때 주의할 점  

### 1. Optional을 활용한 값 반환  
✅ 예외를 던지는 대신 `Optional.empty()`를 반환하는 것이 낫다.  
✅ `Optional.of(value)`를 사용할 때 `null`을 넣으면 `NullPointerException`이 발생하므로 주의해야 한다.  
✅ `Optional.ofNullable(value)`를 사용하면 `null`을 `Optional.empty()`로 안전하게 변환할 수 있지만, **가능하면 메서드의 반환 타입을 Optional<T>로 선언하여 `null`을 직접 다루지 않도록 하는 것이 바람직하다.**  

### 2. 스트림을 활용한 최적화  
✅ `Stream API`를 이용하면 `max()` 등의 연산에서 `Optional`을 자연스럽게 반환할 수 있다.  
✅ `Collection`에서 최댓값을 찾는 경우, `Optional<T>`를 반환하면 `null` 체크 없이 간결한 코드 작성이 가능하다.  

### 3. 옵셔널을 활용한 기본값 설정  
✅ `.orElse("기본값")`을 사용하여 기본값을 제공할 수 있다.  
✅ `.orElseThrow()`를 활용하면 원하는 예외를 던질 수 있다.  
✅ `.get()`을 사용하면 값이 없을 경우 `NoSuchElementException`이 발생하므로, 반드시 값이 존재한다고 확신하는 경우에만 사용해야 한다.  

### 4. 옵셔널을 활용한 안전한 연산  
✅ `.isPresent()`를 사용하여 값이 존재하는지 확인할 수 있지만, **가능하면 `.map()`이나 `.orElse()` 같은 메서드로 대체하는 것이 좋다.**  
✅ `.map()`을 사용하면 `Optional<T>` 내부의 값을 변환할 수 있으며, `.flatMap()`을 활용하면 중첩된 `Optional<T>`를 처리할 수 있다.  

### 5. 옵셔널을 잘못 사용하는 사례  
❌ `Optional<T>`를 **컬렉션, 배열, 키-값 맵의 키 또는 값으로 사용하는 것은 적절하지 않다.**  
❌ 성능이 중요한 상황에서는 `Optional<T>`를 남용하면 **불필요한 객체 할당으로 인해 성능 저하가 발생할 수 있다.**  
✅ 박싱된 기본 타입을 감싼 `Optional<Integer>`보다는 `OptionalInt` 같은 기본형 전용 클래스를 사용하는 것이 더 효율적이다.  

---

## 핵심 정리  
✔ 값이 없을 가능성이 있는 메서드는 `Optional<T>`를 반환하는 것이 유용하다.  
✔ 그러나 성능이 중요한 경우에는 `null`을 반환하는 것이 더 나을 수도 있다.  
✔ `Optional<T>`는 반환 값으로만 사용해야 하며, **필드나 컬렉션 요소로 사용하는 것은 바람직하지 않다.**  
✔ `Optional<T>`를 적절히 활용하면 **`null`과 예외 처리를 최소화하면서 가독성과 안정성을 높일 수 있다.**  
